<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>who</h1>
</body>
<script>
// 函数进阶
    // function sumTo(n) {
    //     if (n == 1) return 1;
    //     return (n+ sumTo(n-1));
    // }
    // alert( sumTo(100) );


    // function factorial(n) {
    //     return (n==1)? 1: n* factorial(n-1)
    // }
    // alert( factorial(5) );


    // function fib(n) {
    //     /* 你的代码 */
    //     let serial = [1,1];
    //     if (n == 2 || n == 1){
    //         return 1;
    //     }else{
    //         for (i = 3 ;i<=n; i++){
    //             serial[i-1] = serial[i-2] + serial[i-3];
    //         }
    //         return serial[n-1];
    //     }
    // }
    // alert(fib(3)); // 2
    // alert(fib(7)); // 13
    // alert(fib(77)); // 5527939700884757


    // function printList(list) {
    //     alert(list.value);
    //     if (list.next != null) {
    //         printList(list.next);
    //     }
    // }
    // let list = {
    //     value: 1,
    //     next: {
    //         value: 2,
    //         next: {
    //             value: 3,
    //             next: {
    //                 value: 4,
    //                 next: null
    //             }
    //         }
    //     }
    // };
    // printList(list)


    // function printListReverse(list) {
    //     let tmp = list;
    //     let tmpAlert = [];
    //     while (tmp) {
    //         tmpAlert.push(tmp.value);
    //         tmp = tmp.next;
    //     }
    //     for (let i = tmpAlert.length - 1; i >= 0; i--) {
    //         alert(tmpAlert[i]);
    //     }
    // }
    // function printListReverse(list) {

    //     if (list.next) {
    //         printListReverse(list.next);
    //         // return;
    //     }
    //     alert(list.value);

    // }
    // let list = {
    //     value: 1,
    //     next: {
    //         value: 2,
    //         next: {
    //             value: 3,
    //             next: {
    //                 value: 4,
    //                 next: null
    //             }
    //         }
    //     }
    // };
    // printListReverse(list);



    // function makeCounter() {
    //     let count = 0;

    //     return function () {
    //         return count++;
    //     };
    // }

    // let counter = makeCounter();
    // let counter2 = makeCounter();

    // alert(counter()); // 0
    // alert(counter()); // 1

    // alert(counter2()); // ?
    // alert(counter2()); // ?


    // function sum(n) {
    //     let ans = n;
    //     return function (m) {
    //         return ans += m;
    //     }
    // }

    // alert(sum(1)(2));
    // // sum(5)(-1) = 4


    // function inBetween(a, b) {
    //     return function (n) {
    //         return (n >= a) && (n <= b);
    //     }
    // }
    // function inArray(arr) {
    //     return function (n) {
    //         return arr.includes(n);
    //     }
    // }
    // let arr = [1, 2, 3, 4, 5, 6, 7];
    // alert(arr.filter(inBetween(3, 6))); // 3,4,5,6
    // alert(arr.filter(inArray([1, 2, 10]))); // 1,2



    // function byField(fieldName) {
    //     if (fieldName == "name") {
    //         return function (a, b) {
    //             return a.name > b.name ? 1 : -1;
    //         }
    //     } else if (fieldName == "age") {
    //         return function (a, b) {
    //             return a.age > b.age ? 1 : -1;
    //         }
    //     }
    // }
    // users.sort(byField('name'));
    // users.sort(byField('age'));


    // function makeArmy() {
    //     let shooters = [];

    //     let i = 0;
    //     while (i < 10) {

    //         let mm = i;
    //         let shooter = function () { // 创建一个 shooter 函数，
    //             alert(mm); // 应该显示其编号
    //         };
    //         shooters.push(shooter); // 将此 shooter 函数添加到数组中
    //         i++;

    //     }

    //     // ……返回 shooters 数组
    //     return shooters;
    // }

    // let army = makeArmy();

    // // ……所有的 shooter 显示的都是 10，而不是它们的编号 0, 1, 2, 3...
    // alert(army[0]()); // 编号为 0 的 shooter 显示的是 10
    // alert(army[1]()); // 编号为 1 的 shooter 显示的是 10
    // alert(army[2]()); // 10，其他的也是这样。


    // function ask(question, ...handlers) {
    //     let isYes = confirm(question);

    //     for (let handler of handlers) {
    //         if (handler.length == 0) {
    //             if (isYes) handler();
    //         } else {
    //             handler(isYes);
    //         }
    //     }

    // }
    // // 对于积极的回答，两个 handler 都会被调用
    // // 对于负面的回答，只有第二个 handler 被调用
    // ask("Question?", () => alert('You said yes'), result => alert(result));



    // function makeCounter() {
    //     // 不需要这个了
    //     // let count = 0

    //     function counter() {
    //         return counter.count++;
    //     };
    //     counter.set = function (value) {
    //         counter.count = value;
    //     }
    //     counter.decreate = function (value) {
    //         counter.count--;
    //     }

    //     counter.count = 0;

    //     return counter;
    // }


    // function sum(a) {
    //     const next = (b) => sum(a + b);
    //     next.valueOf = () => a;
    //     return next;
    // }


    // function printNumbers(from, to) {
    //     let i = from;

    //     setInterval(() => {
    //         if (i <= to) {
    //             alert(i);

    //         }
    //         i++;
    //     }, 1000);

    // }
    // function printNumbers(from, to) {
    //     let i = from;
    //     setTimeout(function printit() {
    //         alert(i);
    //         i++;
    //         if (i <= to) {
    //             printit();
    //         }
    //     }, 1000);
    // }
    // printNumbers(5, 10);


    // 间谍装饰器
    // function work(a, b) {
    //     alert(a + b); // work 是一个任意的函数或方法
    // }
    // 间谍装饰器
    // function spy(func) {
    //     let calls= [];
    //     return function c() {
    //         // let key = [].join.call(arguments);

    //         calls.push(Array.from(arguments));
    //         c.calls = calls;
    //         return func.call( this, ...arguments)
    //     }
    // }

    // work = spy(work);
    // work(1, 2); // 3
    // work(4, 5); // 9

    // for (let args of work.calls) {
    //     alert('call:' + args.join()); // "call:1,2", "call:4,5"
    // }

    // 延时装饰器
    // function f(x) {
    //     alert(x);
    // }

    // // create wrappers
    // function delay(f, ms) {
    //     return function () {
    //         setTimeout(()=>f.call(this, ...arguments), ms);
    //     }
    // }
    // let f1000 = delay(f, 1000);
    // let f1500 = delay(f, 1500);

    // f1000("test"); // 在 1000ms 后显示 "test"
    // f1500("test"); // 在 1500ms 后显示 "test"

    // 防抖装饰器
    // function debounce(f, ms) {
    //     let timeoutSign;
    //     return function () {
    //         clearTimeout(timeoutSign);
    //         timeoutSign = setTimeout( () =>{
    //             return f.call(this, ...arguments);
    //         }, ms);
    //     }
    // }
    // let f = debounce(alert, 1000);

    // f("a");
    // setTimeout(() => f("b"), 200);
    // setTimeout(() => f("c"), 500);
    // 防抖函数从最后一次函数调用以后等待 1000ms，然后执行：alert("c")



    // // 节流装饰器
    // function f(a) {
    //     console.log(a);
    // }

    // function throttle(func, ms) {
    //     let signal = false;
    //     return function () {
    //         if (signal == true) {
    //             newthis = this;
    //             newarg = arguments;
    //         } else {
    //             func.apply(this, arguments);
    //             signal = true;
    //             newthis = this;
    //             newarg = arguments;
    //             setTimeout(() => {
    //                 func.apply(newthis, newarg);
    //                 newthis = newarg = null;
    //             }, 1000);
    //         }
    //     }
    // }
    // // f1000 最多每 1000ms 将调用传递给 f 一次
    // let f1000 = throttle(f, 1000);

    // f1000(1); // 显示 1
    // f1000(2); // (节流，尚未到 1000ms)
    // f1000(3); // (节流，尚未到 1000ms)

    // // 当 1000ms 时间到...
    // // ...输出 3，中间值 2 被忽略



    // 修复丢失了 "this" 的函数
    // function askPassword(ok, fail) {
    //     let password = prompt("Password?", '');
    //     if (password == "rockstar") ok();
    //     else fail();
    // }

    // let user = {
    //     name: 'John',

    //     loginOk() {
    //         alert(`${this.name} logged in`);
    //     },

    //     loginFail() {
    //         alert(`${this.name} failed to log in`);
    //     },

    // };

    // askPassword(()=>user.loginOk(), ()=>user.loginFail());


    // 偏函数在登录中的应用
    // function askPassword(ok, fail) {
    //     let password = prompt("Password?", '');
    //     if (password == "rockstar") ok();
    //     else fail();
    // }

    // let user = {
    //     name: 'John',

    //     login(result) {
    //         alert(this.name + (result ? ' logged in' : ' failed to log in'));
    //     }
    // };

    // askPassword(user.login.bind(user, true), user.login.bind(user, false)); // ?



    //给函数添加一个 "f.defer(ms)" 方法
    // Function.prototype.defer = function (ms) {
    //     setTimeout(this, ms);
    // }
    // function f() {
    //     alert("Hello!");
    // }
    // f.defer(1000); // 1 秒后显示 "Hello!"



    //将装饰器 "defer()" 添加到函数
    // Function.prototype.defer = function (ms) {
    //     func = this;
    //     return function () {
    //         setTimeout(()=>func.apply(this, arguments), ms);

    //     }

    // }
    // function f() {
    //     alert("Hello!");
    // }
    // f.defer(1000)(1, 2); // 1 秒后显示 "Hello!"


    //为 dictionary 添加 toString 方法
    // let dictionary = Object.create(null);
    // dictionary.toString = function () {

    //     return Object.keys(this).toString();

    // }
    // Object.defineProperty(dictionary, "toString", {
    //     enumerable: false
    // });
    // // 你的添加 dictionary.toString 方法的代码

    // // 添加一些数据
    // dictionary.apple = "Apple";
    // dictionary.__proto__ = "test"; // 这里 __proto__ 是一个常规的属性键

    // // 在循环中只有 apple 和 __proto__
    // for (let key in dictionary) {
    //     alert(key); // "apple", then "__proto__"
    // }

    // // 你的 toString 方法在发挥作用
    // alert(dictionary); // "apple,__proto__"


    // function Clock({ template }) {

    //     let timer;

    //     function render() {
    //         let date = new Date();

    //         let hours = date.getHours();
    //         if (hours < 10) hours = '0' + hours;

    //         let mins = date.getMinutes();
    //         if (mins < 10) mins = '0' + mins;

    //         let secs = date.getSeconds();
    //         if (secs < 10) secs = '0' + secs;

    //         let output = template
    //             .replace('h', hours)
    //             .replace('m', mins)
    //             .replace('s', secs);

    //         console.log(output);
    //     }

    //     this.stop = function () {
    //         clearInterval(timer);
    //     };

    //     this.start = function () {
    //         render();
    //         timer = setInterval(render, 1000);
    //     };

    // }




    class Clock {


        constructor({ template }) {
            this.template = template;
        }

        render() {
            this.date = new Date();

            this.hours = this.date.getHours();
            if (this.hours < 10) this.hours = '0' + this.hours;

            this.mins = this.date.getMinutes();
            if (this.mins < 10) this.mins = '0' + this.mins;

            this.secs = this.date.getSeconds();
            if (this.secs < 10) this.secs = '0' + this.secs;

            this.output = this.template
                .replace('h', this.hours)
                .replace('m', this.mins)
                .replace('s', this.secs);

            console.log(this.output);
        }
        stop() {
            clearInterval(this.timer);
        }
        start() {
            this.render();
            this.timer = setInterval(() => this.render(), 1000);
        }
    }
    let clock = new Clock({ template: 'h:m:s' });
    clock.start();
</script>

</html>